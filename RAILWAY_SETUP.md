# Настройка Railway для Django проекта

## Переменные окружения в Railway

Убедитесь, что в настройках Railway (Variables) установлены следующие переменные:

### Обязательные переменные:
- `SECRET_KEY`: `6*%q5mnxa9c#845d)vqp-3q2j4ec&t3dm&(cn=7kvl$-8m36ui`
- `DEBUG`: `True` (временно для отладки)
- `DATABASE_URL`: Автоматически устанавливается Railway при подключении PostgreSQL

### Дополнительные переменные (опционально):
- `ALLOWED_HOSTS`: `uniclothes.up.railway.app,localhost,127.0.0.1`

## Настройка PostgreSQL

1. **Подключение базы данных:**
   - В Railway Dashboard перейдите в раздел "Plugins"
   - Убедитесь, что PostgreSQL добавлен и подключен к вашему сервису
   - В разделе "Variables" должна появиться переменная `DATABASE_URL`

2. **Проверка подключения:**
   - В настройках PostgreSQL найдите кнопку "Connect"
   - Выберите "Public Network"
   - Скопируйте Connection URL - он должен содержать `shinkansen.proxy.rlwy.net:19416`

## Проверка деплоя

1. После пуша в GitHub, Railway автоматически пересоберет проект
2. В логах Railway должна появиться команда `release: python manage.py migrate --noinput`
3. После успешного применения миграций запустится веб-сервер

## Возможные проблемы

### 400 Bad Request
- Проверьте, что SECRET_KEY в Railway совпадает с тем, что в коде
- Убедитесь, что DEBUG=False в продакшене
- Проверьте, что ALLOWED_HOSTS содержит ваш домен

### Проблемы с базой данных
- Убедитесь, что PostgreSQL подключен к проекту
- Проверьте, что в DATABASE_URL используется внешний адрес (shinkansen.proxy.rlwy.net:19416)
- В Railway Dashboard -> Data должен показываться ваш проект после успешных миграций

### Ошибка "could not translate host name postgres.railway.internal"
- Эта ошибка исправлена в коде - теперь используется внешний адрес базы данных
- Если ошибка повторяется, проверьте, что последние изменения задеплоены

### Проблемы со статическими файлами
- WhiteNoise автоматически обрабатывает статические файлы
- Убедитесь, что все статические файлы находятся в папке `clotheshop/static/`

## Команды для отладки

Если нужно проверить логи:
1. В Railway Dashboard перейдите в раздел "Deployments"
2. Выберите последний деплой и посмотрите логи

Если нужно применить миграции вручную:
1. В Railway Dashboard перейдите в "Variables"
2. Добавьте переменную `COMMAND` со значением `python manage.py migrate`
3. Перезапустите деплой

## Проверка работоспособности

После успешного деплоя:
1. Откройте сайт https://uniclothes.up.railway.app
2. Проверьте, что главная страница загружается
3. В Railway Dashboard -> Data должны появиться таблицы Django 